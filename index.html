<!DOCTYPE html>
<html>
<head>
  <title>Samsung TV Remote HTML App</title>
</head>
<body>
  <h2>Samsung TV Remote</h2>
  <label for="tvip">TV IP Address:</label>
  <input id="tvip" type="text" value="192.168.1.x">
  <button onclick="connectTV()">Connect</button>
  <div id="status"></div>
  <br>
  <button onclick="sendKey('KEY_POWER')">Power</button>
  <button onclick="sendKey('KEY_VOLUP')">Volume +</button>
  <button onclick="sendKey('KEY_VOLDOWN')">Volume -</button>
  <button onclick="sendKey('KEY_ENTER')">OK</button>

  <script>
    let ws = null;

    function connectTV() {
      const ip = document.getElementById('tvip').value;
      // Replace the name parameter with your device name base64-encoded (e.g., 'HTML_REMOTE')
      const nameBase64 = btoa('HTML_REMOTE');
      ws = new WebSocket('wss://' + ip + ':8002/api/v2/channels/samsung.remote.control?name=' + nameBase64);

      ws.onopen = function() {
        document.getElementById('status').innerText = "Connected!";
      };
      ws.onerror = function(e) {
        document.getElementById('status').innerText = "Error connecting!";
      };
      ws.onclose = function(e) {
        document.getElementById('status').innerText = "Disconnected!";
      };
    }

    function sendKey(key) {
      if (!ws || ws.readyState !== WebSocket.OPEN) {
        alert("Please connect first!");
        return;
      }
      const msg = {
        method: "ms.remote.control",
        params: {
          Cmd: "Click",
          DataOfCmd: key,
          Option: "false",
          TypeOfRemote: "SendRemoteKey"
        }
      };
      ws.send(JSON.stringify(msg));
    }
  </script>
</body>
</html>
